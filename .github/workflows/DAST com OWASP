  dast:
    name: DAST Scan (ZAP)
    runs-on: ubuntu-latest
    needs: build

    steps:
    - name: Checkout code
      uses: actions/checkout@v4

    - name: Setup .NET
      uses: actions/setup-dotnet@v4
      with:
        dotnet-version: 8.0.x

    - name: Restore and build
      run: |
        dotnet restore
        dotnet build --no-restore
      working-directory: LibraryOnlineRentalSystem

    - name: Start application
      run: |
        nohup dotnet run --urls "http://localhost:5000" &
      working-directory: LibraryOnlineRentalSystem

    - name: Wait for app to start
      run: sleep 10

    - name: Run OWASP ZAP baseline scan
      uses: zaproxy/action-baseline@v0.11.0
      with:
        target: 'http://localhost:5000'
        fail_action: false
        allow_issue_writing: false
